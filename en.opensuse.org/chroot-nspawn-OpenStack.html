<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="generator" content="MediaWiki 1.17.0" />
        <meta name="google-translate-customization" content="ff060e8e1031118-4d58824d5f4d4df5-g02cf4f6d365b324e-31"></meta>
<link rel="shortcut icon" href="https://www.opensuse.org/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="https://en.opensuse.org/opensearch_desc.php" title="openSUSE (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://en.opensuse.org/api.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="openSUSE Atom feed" href="https://en.opensuse.org/index.php?title=Special:RecentChanges&amp;feed=atom" />        <title>User:Tsu2/chroot-nspawn-OpenStack - openSUSE</title>
        <link rel="stylesheet" href="../load.php@debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint,shared&amp;only=styles&amp;skin=bentofluid&amp;%252A.css" />
<link rel="stylesheet" href="https://static.opensuse.org/themes/bento/css/style.fluid.css" media="screen" /><meta name="ResourceLoaderDynamicStyles" content="" /><link rel="stylesheet" href="../load.php@debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=bentofluid&amp;%252A.css" />
<link rel="stylesheet" href="../load.php@debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=bentofluid&amp;%252A.css" />
<link rel="stylesheet" href="../load.php@debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=bentofluid&amp;%252A.css" />
        <link rel="stylesheet" href="../skins/bento/css_local/style.css" type="text/css" media="screen" />
        <!--[if lt IE 7]>
        <meta http-equiv="imagetoolbar" content="no" />
        <![endif]-->
        <script>if ( window.mediaWiki ) {
	mediaWiki.config.set({"wgCanonicalNamespace": "User", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 2, "wgPageName": "User:Tsu2/chroot-nspawn-OpenStack", "wgTitle": "Tsu2/chroot-nspawn-OpenStack", "wgAction": "view", "wgArticleId": 9625, "wgIsArticle": true, "wgUserName": null, "wgUserGroups": ["*"], "wgCurRevisionId": 59961, "wgCategories": [], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": [], "wgWikiEditorEnabledModules": {"toolbar": true, "dialogs": true, "templateEditor": false, "templates": false, "addMediaWizard": false, "preview": true, "previewDialog": false, "publish": false, "toc": false}, "wgFlaggedRevsParams": {"tags": {"accuracy": {"levels": 3, "quality": 2, "pristine": 4}, "depth": {"levels": 3, "quality": 1, "pristine": 4}, "style": {"levels": 3, "quality": 1, "pristine": 4}}}, "wgStableRevisionId": null, "wgRevContents": {"error": "Unable to get content.", "waiting": "Waiting for content"}, "sfgRemoveText": "Remove", "sfgAutocompleteOnAllChars": false, "
sfgAutocompleteValues": {}, "sfgShowOnSelect": {}, "sfgFormErrorsHeader": "There were errors with your form input; see below", "sfgBlankErrorStr": "cannot be blank", "sfgBadURLErrorStr": "must have the correct URL format, starting with \"http\"", "sfgBadEmailErrorStr": "must have a valid email address format", "sfgBadNumberErrorStr": "must be a valid number", "sfgBadDateErrorStr": "must be a valid date", "sfgAnonEditWarning": "Warning: You are not logged in. Your IP address will be recorded in this page\'s edit history.", "egMapsDebugJS": false});
}
</script>        <script type="text/javascript" src="../skins/common/wikibits.js@301"><!-- wikibits js --></script>
        <script type="text/javascript" src="https://static.opensuse.org/stage/themes/bento/js/jquery.js"></script>
        <script type="text/javascript" src="https://static.opensuse.org/stage/themes/bento/js/script.js"></script>
        <script type="text/javascript" src="../skins/bento/js_local/script.js"></script>
        <script type="text/javascript" src="../skins/bento/js_local/search.js"></script>

        <script type="text/javascript" src="https://static.opensuse.org/themes/bento/js/l10n/global-navigation-data-en.js"></script>
        <script type="text/javascript" src="https://static.opensuse.org/themes/bento/js/global-navigation.js"></script>

        <link rel="icon" type="image/png" href="https://static.opensuse.org/themes/bento/images/favicon.png" />

        <!-- Head Scripts -->
                <style type="text/css">/*<![CDATA[*/
.source-cpp {line-height: normal;}
.source-cpp li, .source-cpp pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for cpp
 * CSS class: source-cpp, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.cpp.source-cpp .de1, .cpp.source-cpp .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;}
.cpp.source-cpp  {font-family:monospace;}
.cpp.source-cpp .imp {font-weight: bold; color: red;}
.cpp.source-cpp li, .cpp.source-cpp .li1 {font-weight: normal; vertical-align:top;}
.cpp.source-cpp .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.cpp.source-cpp .li2 {font-weight: bold; vertical-align:top;}
.cpp.source-cpp .kw1 {color: #0000ff;}
.cpp.source-cpp .kw2 {color: #0000ff;}
.cpp.source-cpp .kw3 {color: #0000dd;}
.cpp.source-cpp .kw4 {color: #0000ff;}
.cpp.source-cpp .co1 {color: #666666;}
.cpp.source-cpp .co2 {color: #339900;}
.cpp.source-cpp .coMULTI {color: #ff0000; font-style: italic;}
.cpp.source-cpp .es0 {color: #000099; font-weight: bold;}
.cpp.source-cpp .es1 {color: #000099; font-weight: bold;}
.cpp.source-cpp .es2 {color: #660099; font-weight: bold;}
.cpp.source-cpp .es3 {color: #660099; font-weight: bold;}
.cpp.source-cpp .es4 {color: #660099; font-weight: bold;}
.cpp.source-cpp .es5 {color: #006699; font-weight: bold;}
.cpp.source-cpp .br0 {color: #008000;}
.cpp.source-cpp .sy0 {color: #008000;}
.cpp.source-cpp .sy1 {color: #000080;}
.cpp.source-cpp .sy2 {color: #000040;}
.cpp.source-cpp .sy3 {color: #000040;}
.cpp.source-cpp .sy4 {color: #008080;}
.cpp.source-cpp .st0 {color: #FF0000;}
.cpp.source-cpp .nu0 {color: #0000dd;}
.cpp.source-cpp .nu6 {color: #208080;}
.cpp.source-cpp .nu8 {color: #208080;}
.cpp.source-cpp .nu12 {color: #208080;}
.cpp.source-cpp .nu16 {color:#800080;}
.cpp.source-cpp .nu17 {color:#800080;}
.cpp.source-cpp .nu18 {color:#800080;}
.cpp.source-cpp .nu19 {color:#800080;}
.cpp.source-cpp .me1 {color: #007788;}
.cpp.source-cpp .me2 {color: #007788;}
.cpp.source-cpp .ln-xtra, .cpp.source-cpp li.ln-xtra, .cpp.source-cpp div.ln-xtra {background-color: #ffc;}
.cpp.source-cpp span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "../index.php@title=MediaWiki%253AGeshi.css&usemsgcache=yes&action=raw&ctype=text%252Fcss&smaxage=18000.css";
/*]]>*/
</style>		<link rel="alternate" type="application/rdf+xml" title="User:Tsu2/chroot-nspawn-OpenStack" href="https://en.opensuse.org/index.php?title=Special:ExportRDF/User:Tsu2/chroot-nspawn-OpenStack&amp;xmlmime=rdf" />
                                                                        
    <!-- Piwik -->
    <script type="text/javascript">
      var _paq = _paq || [];
      (function(){
        var u=(("https:" == document.location.protocol) ? "https://beans.opensuse.org/piwik/" : "http://beans.opensuse.org/piwik/");
        _paq.push(['setSiteId', 9]);
        _paq.push(['setTrackerUrl', u+'piwik.php']);
        _paq.push(['trackPageView']);
        _paq.push([ 'setDomains', ["*.opensuse.org"]]);
        var d=document,
        g=d.createElement('script'),
        s=d.getElementsByTagName('script')[0];
        g.type='text/javascript';
        g.defer=true;
        g.async=true;
        g.src=u+'piwik.js';
        s.parentNode.insertBefore(g,s);
      })();
    </script>
    <!-- End Piwik Code -->


    </head>

    <body                                                               class="mediawiki ltr ns-2 ns-subject page-User_Tsu2_chroot-nspawn-OpenStack skin-bentofluid">

        <!-- Start: Header -->
                  <!-- Start: Header -->
  <div id="header">
    <div id="header-content" class="container_12">
      <a id="header-logo" href="http://www.opensuse.org"><img src="../skins/bento/header-logo.png" width="46" height="26" alt="Header Logo" /></a>
      <ul id="global-navigation">
        <li id="item-downloads"><a href="https://en.opensuse.org/openSUSE:Browse#Downloads">Downloads</a></li>
        <li id="item-support"><a href="https://en.opensuse.org/openSUSE:Browse#Support">Support</a></li>
        <li id="item-community"><a href="https://en.opensuse.org/openSUSE:Browse#Community">Community</a></li>
        <li id="item-development"><a href="https://en.opensuse.org/openSUSE:Browse#Development">Development</a></li>
      </ul>
      <form id="global-search-form" action="https://en.opensuse.org/Special:Search" method="post" accept-charset="utf-8">
        <label for="search">Search</label>
        <input type="text" name="search" value="" id="search" />
        <input type="submit" name="go" class="hidden"  value="Search"  title="Go to a page with this exact name if exists"/>
      </form>
    </div>
  </div>
  <!-- End: Header -->
        <!-- End: Header -->
        <div id="google_translate_element"></div><script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en'}, 'google_translate_element');
}
</script><script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
        <div id="subheader" class="container_16">
            <div id="breadcrump" class="grid_12 alpha">
                <a href="https://en.opensuse.org/" title="Home"><img src="../skins/bento/home_grey.png" width="16" height="16" alt="Home" /> Wiki</a> &gt; <a href="chroot-nspawn-OpenStack.html" title="">User:Tsu2/chroot-nspawn-OpenStack</a>
            </div>


                    <div id="login-wrapper" class="grid_4 omega">
                <a href="https://en.opensuse.org/index.php?title=Special:UserLogin&amp;returnto=User:Tsu2/chroot-nspawn-OpenStack">Sign up</a> | <a id="login-trigger" href="chroot-nspawn-OpenStack.html#login">Login</a>

                <div id="login-form">
		                        <form action="https://login.attachmategroup.com/nidp/idff/sso?sid=0" method="post" enctype="application/x-www-form-urlencoded" name="login_form">
                    		    <input name="target" value="http://en.opensuse.org/index.php?title=Special:UserLogin&returnto=User:Tsu2/chroot-nspawn-OpenStack" type="hidden"/>
                        <input name="context" value="default" type="hidden"/>
                        <input name="proxypath" value="reverse" type="hidden"/>
                        <input name="message" value="Please log In" type="hidden"/>
                        <p><label class="inlined" for="username">Username</label><input type="text" class="inline-text" name="Ecom_User_ID" value="" id="username" /></p>
                        <p><label class="inlined" for="password">Password</label><input type="password" class="inline-text" name="Ecom_Password" value="" id="password" /></p>
                        <p><input type="submit" value="Login" /></p>
                        <p class="slim-footer"><a id="close-login" href="chroot-nspawn-OpenStack.html#cancel">Cancel</a></p>
                    </form>
                </div>
            </div>
            
        </div>

        <!-- Start: Main Content Area -->
        <div id="content" class="container_16 content-wrapper">

            <div class="column grid_3 alpha">

               <!-- Begin custom navigation -->
                              <div id="some_other_content" class="box box-shadow alpha clear-both navigation">
               <h2 class="box-header">
                  Navigation               </h2>
                 <ul class="navigation">
                                    <li><a href="https://en.opensuse.org/Main_Page">Main page</a></li>
                                    <li><a href="https://en.opensuse.org/openSUSE:Community_portal">Community portal</a></li>
                                    <li><a href="https://en.opensuse.org/openSUSE:Current_events">Current events</a></li>
                                    <li><a href="https://en.opensuse.org/Special:RecentChanges">Recent changes</a></li>
                                    <li><a href="https://en.opensuse.org/Special:Random">Random page</a></li>
                                    <li><a href="https://en.opensuse.org/Help:Contents">Help</a></li>
                                   </ul>          
               </div>
                              <div id="some_other_content" class="box box-shadow alpha clear-both navigation">
               <h2 class="box-header">
                  SEARCH               </h2>
                 <ul class="navigation">
                                   </ul>          
               </div>
                              <div id="some_other_content" class="box box-shadow alpha clear-both navigation">
               <h2 class="box-header">
                  TOOLBOX               </h2>
                 <ul class="navigation">
                                   </ul>          
               </div>
                              <div id="some_other_content" class="box box-shadow alpha clear-both navigation">
               <h2 class="box-header">
                  LANGUAGES               </h2>
                 <ul class="navigation">
                                   </ul>          
               </div>
               

                <div id="some_other_content" class="box box-shadow alpha clear-both navigation">
                    <h2 class="box-header">Toolbox</h2>
                    <ul class="navigation">
                                <li id="t-whatlinkshere"><a href="https://en.opensuse.org/Special:WhatLinksHere/User:Tsu2/chroot-nspawn-OpenStack" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
                                    <li id="t-recentchangeslinked"><a href="https://en.opensuse.org/Special:RecentChangesLinked/User:Tsu2/chroot-nspawn-OpenStack" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
                
                                                                                                <li id="t-contributions"><a href="https://en.opensuse.org/Special:Contributions/Tsu2">User contributions</a></li>
                                        <li id="t-specialpages"><a href="https://en.opensuse.org/Special:SpecialPages">Special pages</a></li>
                                    </ul>
                </div>

                <div id="some_other_content" class="box box-shadow alpha clear-both navigation">
                    <h2 class="box-header">Sponsors</h2>
                                        <a class="sponsor-image" href="https://en.opensuse.org/Sponsors"><img src="https://static.opensuse.org/themes/bento/images/sponsors/sponsor_b1-systems.png" alt="Sponsor" style="max-width: 145px;"/></a>
                </div>


        

            </div>


                        

            <div id="some-content" class="box box-shadow grid_13 clearfix">
                <!-- box header -->
                <div class="box-header header-tabs">
                    <ul>
                                <li><a href="chroot-nspawn-OpenStack.html" class="selected" title="View the user page [c]" accesskey="c">User page</a></li><li><a href="https://en.opensuse.org/index.php?title=User_talk:Tsu2/chroot-nspawn-OpenStack&amp;action=edit&amp;redlink=1" class="new" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li><li><a href="https://en.opensuse.org/index.php?title=User:Tsu2/chroot-nspawn-OpenStack&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li><li><a href="https://en.opensuse.org/index.php?title=User:Tsu2/chroot-nspawn-OpenStack&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>                    </ul>
                </div>
                <div id="contentSub"><span class="subpages">&lt; <a href="https://en.opensuse.org/User:Tsu2" title="User:Tsu2">User:Tsu2</a></span></div>
                <!-- End: box header -->


                <a name="top" id="top"></a>

                <div class="alpha omega">
                    <h1>User:Tsu2/chroot-nspawn-OpenStack</h1>

                    <h3 id="siteSub">tagline: From openSUSE</h3>
                    <!-- <div id="contentSub"><span class="subpages">&lt; <a href="/User:Tsu2" title="User:Tsu2">User:Tsu2</a></span></div> -->
                                    
                    <!-- Begin Content Area -->
                            <table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="chroot-nspawn-OpenStack.html#Deploying_OpenStack_Folsom_on_openSUSE_12.3_using_a_chroot"><span class="tocnumber">1</span> <span class="toctext">Deploying OpenStack Folsom on openSUSE 12.3 using a chroot</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="chroot-nspawn-OpenStack.html#Pre-Introduction"><span class="tocnumber">1.1</span> <span class="toctext">Pre-Introduction</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="chroot-nspawn-OpenStack.html#Introduction"><span class="tocnumber">1.2</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="chroot-nspawn-OpenStack.html#1._Setting_up_the_chroot"><span class="tocnumber">1.3</span> <span class="toctext">1. Setting up the chroot</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="chroot-nspawn-OpenStack.html#For_those_new_to_chroot.2C"><span class="tocnumber">1.3.1</span> <span class="toctext">For those new to chroot,</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-6"><a href="chroot-nspawn-OpenStack.html#2._Chrooting_into_the_file_system"><span class="tocnumber">1.4</span> <span class="toctext">2. Chrooting into the file system</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="chroot-nspawn-OpenStack.html#chroot"><span class="tocnumber">1.4.1</span> <span class="toctext">chroot</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="chroot-nspawn-OpenStack.html#systemd-nspawn"><span class="tocnumber">1.4.2</span> <span class="toctext">systemd-nspawn</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="chroot-nspawn-OpenStack.html#lxc"><span class="tocnumber">1.4.3</span> <span class="toctext">lxc</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-10"><a href="chroot-nspawn-OpenStack.html#3._Basic_recommended_modiifications"><span class="tocnumber">1.5</span> <span class="toctext">3. Basic recommended modiifications</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="chroot-nspawn-OpenStack.html#4._Preserve_your_template.2C_work_on_a_Copy"><span class="tocnumber">1.6</span> <span class="toctext">4. Preserve your template, work on a Copy</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="chroot-nspawn-OpenStack.html#5._Setting_up_OpenStack_on_12.3"><span class="tocnumber">1.7</span> <span class="toctext">5. Setting up OpenStack on 12.3</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="chroot-nspawn-OpenStack.html#Additional_Notes:"><span class="tocnumber">1.7.1</span> <span class="toctext">Additional Notes:</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="Deploying_OpenStack_Folsom_on_openSUSE_12.3_using_a_chroot"> Deploying OpenStack Folsom on openSUSE 12.3 using a chroot </span></h2>
<h3> <span class="mw-headline" id="Pre-Introduction"> Pre-Introduction </span></h3>
<p>If you are viewing this as a<b> Machine Translated</b> page, be aware that the content may be modified in unexpected ways. Although a Machine Translated version can be helpful, do keep the original English language version available as the reliable original text.
In particular, console commands will depend on your configured system language and repo URI likely need to be in English.
Use Machine Translation at your own Risk!
</p>
<h3> <span class="mw-headline" id="Introduction"> Introduction </span></h3>
<p>Among other reasons, installing a chroot has a major advantage... When testing or deploying virtualization, creating a virtual machine within another virtual machine can be dog slow. Since chroot creates a mostly isolated OS on hardware without paravirtualization, this removes a virtualization layer so the result is fast and responsive as expected.
</p><p>This Guide assumes that the User is new to chroot and has never set up one before.
This Guide also includes current (updated) information on the Folsom repositories, how to install the Folsom pattern and implementing with systemd-nspawn (recommended).
</p><p><b>If you arrived on this page only to setup and not deploy OpenStack, you only need to follow steps 1-3.</b>
</p><p>The console naming convention used in this Guide, <br /> 
A single hash(#) indicates using the Host console,  <br />
"openstack:~#" indicates using the chroot console.
</p>
<h3> <span class="mw-headline" id="1._Setting_up_the_chroot"> 1. Setting up the chroot </span></h3>
<p>Create chroot Base filesystem(so can be replicated, is a Best Practice so you don't have to always re-create new root file systems), in this example, called "base." Many guides recommend creating your chroots in /var, but because I personally categorize these chroots as Development Environments I prefer to deploy them in my data partition (/home). Regardless where you place your chroot file systems, there must be plenty of available space, minimum 150MB for the base, maybe 1 GB and much more for each additional chroot file system. Currently, a complete openSUSE Folsom file system at the end of this Guide is approx 750MB before further customization.
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1"><span class="co2"># mkdir /home/&lt;username&gt;/chroots/base&lt;/br&gt;</span>
<span class="co2"># zypper --root /home/&lt;username&gt;/chroots/base zypper in zypper wget vi rpm</span></pre></div></div>
<h4> <span class="mw-headline" id="For_those_new_to_chroot.2C"> For those new to chroot, </span></h4>
<p>This will create the basis for a new openSUSE isolated file system to be run within your Host creating necessary mount points but without populating /proc, /sys and /dev
</p><p>This is your most basic portable file system, if you wish you can further install new packages or chroot into the system(described next) and modify if you wish.
</p><p><br />
</p>
<h3> <span class="mw-headline" id="2._Chrooting_into_the_file_system"> 2. Chrooting into the file system </span></h3>
<p>At this point, you have 3 basic options (maybe more, am investigating whether UML, QEMU, and the other fully virtualized technologies like KVM, VMware, Virtualbox and others can use this file system)
</p><p>- <b>chroot</b> The traditional way to "change root" into a virtual file system. By default security is minimal, only the file system is restrictive but the jail can be escaped. Since /proc and /sys are not populated by default, the first time you run on a new system you need to bind mount the mount points. Should be fine for running trusted applications <br />
- <b>systemd-nspawn</b> With systemd 195(openSUSE 12.3 and later), this new method will automatically mount and populate /proc and /sys providing a somewhat more isolated virtualization than Traditional Chroot. Also, by launching as a systemd Unit and unlike a traditional chroot, the child processes spawned theoretically should be managed within a Linux cgroup which means that they should all shutdown properly when exiting. <br />
- <b>lxc</b> The most secure, isolated method which also supports select virtualized services like networking
</p>
<h4> <span class="mw-headline" id="chroot"> chroot </span></h4>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1"><span class="co2"># mount --bind /proc /home/&lt;username&gt;/chroots/openstack/proc/</span>
<span class="co2"># mount --bind /sys /home/&lt;username&gt;/chroots/openstack/sys/</span>
<span class="co2"># chroot ~/chroots/openstack</span></pre></div></div>
<p>When you want to exit
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1">openstack<span class="co2">#:exit</span></pre></div></div>
<p>Perhaps a good idea to verify no running chroot processes
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1"><span class="co2"># umount /home/&lt;username&gt;/chroots/openstack/proc/</span>
<span class="co2"># umount /home/&lt;username&gt;/chroots/openstack/sys/</span></pre></div></div>
<h4> <span class="mw-headline" id="systemd-nspawn"> systemd-nspawn </span></h4>
<p>(Recommended!)
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1">systemd<span class="sy2">-</span>nspawn <span class="sy2">-</span>D <span class="sy2">/</span>home<span class="sy2">/</span><span class="sy1">&lt;</span>username<span class="sy1">&gt;</span><span class="sy2">/</span>chroots<span class="sy2">/</span>openstack</pre></div></div>
<p>When you want to exit
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1">openstack<span class="co2">#: exit</span></pre></div></div>
<h4> <span class="mw-headline" id="lxc"> lxc </span></h4>
<p>- Not covered in this Guide
</p>
<h3> <span class="mw-headline" id="3._Basic_recommended_modiifications"> 3. Basic recommended modiifications </span></h3>
<p>You'll want to install and regularly update your new file system, right? So add the Oss and Update repositories. Although you can do this from "outside" the chroot, let's do this from within to also test how zypper is running in the chroot
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1">openstack<span class="sy4">:</span>~<span class="co2"># zypper ar http://download.opensuse.org/repositories/Cloud:/OpenStack:/Folsom/openSUSE_12.3/ openSUSE-12.3-Oss</span>
openstack<span class="sy4">:</span>~<span class="co2"># zypper ar http://download.opensuse.org/update/12.3/ openSUSE-12.3-Update</span></pre></div></div>
<p>Verify your repo list
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1">openstack<span class="sy4">:</span>~<span class="co2"># zypper lr</span></pre></div></div>
<p>Test your repos by updating all the packages in your new system 
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1">openstack<span class="sy4">:</span>~<span class="co2"># zypper ref</span>
openstack<span class="sy4">:</span>~<span class="co2"># zypper up</span></pre></div></div>
<h3> <span class="mw-headline" id="4._Preserve_your_template.2C_work_on_a_Copy"> 4. Preserve your template, work on a Copy</span></h3>
<p>When you are satisfied with your base system(install any additional packages you may want), copy it so you now have a new working directory.
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1"><span class="co2"># cp -r /home/&lt;username&gt;/chroots/base /home/&lt;username&gt;/chroots/openstack</span></pre></div></div>
<h3> <span class="mw-headline" id="5._Setting_up_OpenStack_on_12.3"> 5. Setting up OpenStack on 12.3 </span></h3>
<p>Currently Folsom is the approved stable release for openSUSE 12.3. If you're runnining on 12.2, Essex is the approved OpenStack release and you likely had to chroot because systemd-nspawn wasn't/isn't available.
</p><p>Curiously, although running zypper from within the chroot works to install many packages, installing the OpenStack packages failed. So, I installed Folsom from the Host (outside the chroot).
</p><p>Assuming you're now logged into your OpenStack (you should see openstack at the console prompt instead of your usual Host directory location), open a second console on the Host
</p><p>First, although you won't be able to install new packages into the chroot from within you'll still want the repo installed for updating
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1">openstack<span class="sy4">:</span>~<span class="co2"># zypper ar http://download.opensuse.org/repositories/Cloud:/OpenStack:/Folsom/openSUSE_12.3/ Cloud_OpenStack_Folsom</span></pre></div></div>
<p>From your Host console,
Add the Folsom repository
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1"><span class="co2"># zypper ar http://download.opensuse.org/repositories/Cloud:/OpenStack:/Folsom/openSUSE_12.3/ Cloud_OpenStack_Folsom</span></pre></div></div>
<p>Refresh your local package database including the repo you just added
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1"><span class="co2"># zypper ref</span></pre></div></div>
<p>Let's see what new OpenStack packages are now available,
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1"><span class="co2"># zypper se openstack</span></pre></div></div>
<p>As you will see the OpenStack "patterns" isn't invoked the usual way with the "-t pattern" flag, it's implemented as a regular package. So, the following will download and install the recommended packages to deploy entirely on a single node, complete with the Quickstart script. But there's a gotcha! I found that libvirt and various other packages wouldn't install properly from within the chroot, So, the solution is to install from outside the chroot.
</p><p>Open a new console on the Host (You don't have to close the chroot console, you can run both side by side).
From the Host console,
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1"><span class="co2"># zypper --root  /home/&lt;username&gt;/chroots/openstack/ in patterns-openstack-controller patterns-openstack-compute-node openstack-quickstart</span></pre></div></div>
<p>Now, from within the chroot console you can verify the new installed packages
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1">openstack<span class="co2">#:~# zypper se openstack</span></pre></div></div>
<p>And run the demosetup script to complete the Test setup
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1">openstack<span class="co2">#:~# /usr/sbin/openstack-quickstart-demosetup</span></pre></div></div>
<p>Play on!
</p>
<h4> <span class="mw-headline" id="Additional_Notes:"> Additional Notes: </span></h4>
<p>If you are running a previous version of openSUSE (eg openSUSE 12.2), although untested the above instructions should work by replacing "Folsom" with "Essex" and using traditional chroot.
</p><p>It's unknown as of yet how "Grizzly" which is currently in "Build Beta" status will be implemented, this document will be updated when officially released.
</p>
<!-- 
NewPP limit report
Preprocessor node count: 207/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key opensuse_en:pcache:idhash:9625-0!*!0!!en!*!edit=0 and timestamp 20130329194440 -->
<div class="printfooter">
Retrieved from "<a href="chroot-nspawn-OpenStack.html">https://en.opensuse.org/User:Tsu2/chroot-nspawn-OpenStack</a>"</div>

        <div id='catlinks' class='catlinks catlinks-allhidden'></div>                            <!-- End Content Area -->

                </div>
                <br/>

                <div class="box-footer header-tabs">
                    <ul>
                                <li><a href="chroot-nspawn-OpenStack.html" class="selected" title="View the user page [c]" accesskey="c">User page</a></li><li><a href="https://en.opensuse.org/index.php?title=User_talk:Tsu2/chroot-nspawn-OpenStack&amp;action=edit&amp;redlink=1" class="new" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li><li><a href="https://en.opensuse.org/index.php?title=User:Tsu2/chroot-nspawn-OpenStack&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li><li><a href="https://en.opensuse.org/index.php?title=User:Tsu2/chroot-nspawn-OpenStack&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>                    </ul>
                </div>

            </div></div>

        <!-- Note: this clears floating, set in previous elements -->
        <div class="clear"></div>


        <!-- Start: Footer -->
                <!-- Start: included footer part -->
<div id="footer" class="container_12">
    <div id="footer-legal" class="border-top grid_12">
        <p>This page has been accessed 52 times.</p><p>
            &copy; 2011 Novell, Inc. and others.  All content  is made available under the terms
            of the GNU Free Documentation License version 1.2 ("GFDL") unless expressly
            otherwise indicated. | <a href="https://en.opensuse.org/Terms_of_site">Terms of site</a>
        </p>
    </div>
</div>

<!-- End: included footer part -->
        <!-- End: Footer -->

        
<script src="../load.php@debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=bentofluid&amp;%252A"></script>
<script>if ( window.mediaWiki ) {
	mediaWiki.config.set({"wgCanonicalNamespace": "User", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 2, "wgPageName": "User:Tsu2/chroot-nspawn-OpenStack", "wgTitle": "Tsu2/chroot-nspawn-OpenStack", "wgAction": "view", "wgArticleId": 9625, "wgIsArticle": true, "wgUserName": null, "wgUserGroups": ["*"], "wgCurRevisionId": 59961, "wgCategories": [], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": [], "wgWikiEditorEnabledModules": {"toolbar": true, "dialogs": true, "templateEditor": false, "templates": false, "addMediaWizard": false, "preview": true, "previewDialog": false, "publish": false, "toc": false}, "wgFlaggedRevsParams": {"tags": {"accuracy": {"levels": 3, "quality": 2, "pristine": 4}, "depth": {"levels": 3, "quality": 1, "pristine": 4}, "style": {"levels": 3, "quality": 1, "pristine": 4}}}, "wgStableRevisionId": null, "wgRevContents": {"error": "Unable to get content.", "waiting": "Waiting for content"}, "sfgRemoveText": "Remove", "sfgAutocompleteOnAllChars": false, "
sfgAutocompleteValues": {}, "sfgShowOnSelect": {}, "sfgFormErrorsHeader": "There were errors with your form input; see below", "sfgBlankErrorStr": "cannot be blank", "sfgBadURLErrorStr": "must have the correct URL format, starting with \"http\"", "sfgBadEmailErrorStr": "must have a valid email address format", "sfgBadNumberErrorStr": "must be a valid number", "sfgBadDateErrorStr": "must be a valid date", "sfgAnonEditWarning": "Warning: You are not logged in. Your IP address will be recorded in this page\'s edit history.", "egMapsDebugJS": false});
}
</script>
<script>if ( window.mediaWiki ) {
	mediaWiki.loader.load(["mediawiki.util", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax"]);
	mediaWiki.loader.go();
}
</script>

<script src="../load.php@debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=bentofluid&amp;%252A"></script>
<script>if ( window.mediaWiki ) {
	mediaWiki.user.options.set({"ccmeonemails":0,"cols":80,"contextchars":50,"contextlines":5,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"bentofluid","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,
	"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"usebetatoolbar":1,"usebetatoolbar-cgd":1,"wikieditor-preview":1,"flaggedrevssimpleui":1,"flaggedrevsstable":false,"flaggedrevseditdiffs":true,"flaggedrevsviewdiffs":false,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"searchNs100":false,"searchNs101":false,"searchNs102":true,"searchNs103":false,"searchNs104":false,"searchNs105":false,"searchNs106":false,"searchNs107":false,"searchNs110":false,"searchNs111":false,"searchNs122":false,"searchNs123":false,"searchNs126":false,"searchNs127":false,"searchNs128":false,"searchNs129":false,
	"searchNs420":false,"searchNs421":false});;mediaWiki.loader.state({"user.options":"ready"});
}
</script>        <!-- Served in 0.097 secs. -->
    </body>
</html>
        